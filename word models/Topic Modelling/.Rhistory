matrix(1:10, nrow=2, byrow = F)
matrix(1:10, nrow=2, byrow = T)
cov(matrix(1:10, nrow=2, byrow = T))
cov(matrix(1:10, nrow=5, byrow = T))
cov(matrix(1:10, nrow=5, byrow = F))
matrix(1:10, nrow=5, byrow = F)
cov(matrix(1:10, nrow=5, byrow = F))
cov(matrix(1:10, nrow=5, byrow = F)) |> eigen
cov(matrix(1:10, nrow=5, byrow = F)) |> eigen()
matrix(1:4, nrow = 2)
matrix(1:4, nrow = 2, byrow = F)
matrix(1:4, nrow = 2, byrow = T)
matrix(4:1, nrow = 2, byrow = T)
matrix(1:4, nrow = 2, byrow = T) %*% matrix(4:1, nrow = 2, byrow = T)
c(0.36547013, -0.95591416,
0.38779302, -0.96239919,
0.21070236,  0.66596198,
0.57770623, -0.37877904,
0.15954916, -0.58598755,
0.94110854, -1.65919069,
0.68798693, -1.88992132,
-0.1973861 ,  1.14440637,
0.26957451,  0.10938816,
-0.54783188, -2.38810149,
1.02767637, -0.41414275,
-0.32948998,  1.00548916,
-1.14673073,  0.75702609,
0.86006276, -1.89961139,
1.67435345, -0.97366957,
0.13409585, -0.33159355,
-0.13005337,  0.84005333,
-0.76418666, -0.75794695,
0.66374471,  0.05667299,
1.21901207, -0.28256518,
-0.38289589,  2.21231776,
-1.01183449,  1.16808071,
0.87220366, -0.47455618,
0.06122276, -1.26641031,
-0.97981413, -1.20630696)
rr= c(0.36547013, -0.95591416,
0.38779302, -0.96239919,
0.21070236,  0.66596198,
0.57770623, -0.37877904,
0.15954916, -0.58598755,
0.94110854, -1.65919069,
0.68798693, -1.88992132,
-0.1973861 ,  1.14440637,
0.26957451,  0.10938816,
-0.54783188, -2.38810149,
1.02767637, -0.41414275,
-0.32948998,  1.00548916,
-1.14673073,  0.75702609,
0.86006276, -1.89961139,
1.67435345, -0.97366957,
0.13409585, -0.33159355,
-0.13005337,  0.84005333,
-0.76418666, -0.75794695,
0.66374471,  0.05667299,
1.21901207, -0.28256518,
-0.38289589,  2.21231776,
-1.01183449,  1.16808071,
0.87220366, -0.47455618,
0.06122276, -1.26641031,
-0.97981413, -1.20630696)
matrix(rr, ncol = 2)
matrix(rr, ncol = 2, byrow = T)
dd = matrix(rr, ncol = 2, byrow = T)
prcomp(dd)
prcomp(dd)$x
cov(dd)
eigen(cov(dd))
eigen(cov(dd))$vectors
rr = c(-0.21863743, -0.33140168,  0.5099132 ,  2.20252799, -0.54560018,
-1.94904831, -0.67608332,  2.15373948, -0.64523754,  0.73561271,
-0.56500211, -1.1181086 ,  0.45536651,  1.16575647,  1.87225202,
-0.12431336, -0.74233273,  0.84508044, -1.74497781,  0.60209008,
0.36286266, -1.65460161,  1.50355519, -0.58690498, -1.41280284,
-0.46332501, -2.0423795 ,  0.5118267 , -0.29545595,  0.31082479,
-0.25556913, -1.90910408, -1.95942441, -0.14948754, -1.01426989,
0.41395884,  1.06308409, -0.21310867, -2.93303164,  1.2877029 ,
0.25242574, -0.39195897,  0.63831222, -0.9840341 ,  0.82177785,
-0.20113291, -1.29344461,  0.36425578, -0.27734873, -0.81784146,
-1.15944921,  1.62837626,  0.37867085, -0.11456555, -0.86259767,
0.46946389,  1.57479632,  0.28815003, -0.61121262,  0.71266001,
0.38611778,  1.80730863,  0.29263131,  0.2750411 , -0.38845123,
-0.11006106,  1.47905292, -1.4105652 ,  0.66418238,  0.18256365,
-1.28256444, -1.3695355 ,  0.42650071,  0.77092494, -0.5305579 ,
0.42480309,  0.34708949,  0.73591252,  0.47403442, -0.77881905,
-0.11366338,  1.00932778, -0.91371139, -0.71324135, -0.30580785,
1.02735852, -0.93417032, -1.47226409,  0.93934866,  0.27471834,
0.03695554, -0.94106201,  0.85831343,  0.26645201, -0.10778799,
-0.00442197,  1.23850543,  0.184529  , -0.14090602,  0.71551067)
dd = matrix(rr, ncol = 2, byrow = T)
dd
dd = matrix(rr, ncol = 5, byrow = T)
dd
cov(dd)
eigen(cov(dd))
rr = c(-0.21863743, -0.33140168,  0.5099132 ,  2.20252799, -0.54560018,
-1.94904831, -0.67608332,  2.15373948, -0.64523754,  0.73561271,
-0.56500211, -1.1181086 ,  0.45536651,  1.16575647,  1.87225202,
-0.12431336, -0.74233273,  0.84508044, -1.74497781,  0.60209008,
0.36286266, -1.65460161,  1.50355519, -0.58690498, -1.41280284,
-0.46332501, -2.0423795 ,  0.5118267 , -0.29545595,  0.31082479,
-0.25556913, -1.90910408, -1.95942441, -0.14948754, -1.01426989,
0.41395884,  1.06308409, -0.21310867, -2.93303164,  1.2877029 ,
0.25242574, -0.39195897,  0.63831222, -0.9840341 ,  0.82177785,
-0.20113291, -1.29344461,  0.36425578, -0.27734873, -0.81784146,
-1.15944921,  1.62837626,  0.37867085, -0.11456555, -0.86259767,
0.46946389,  1.57479632,  0.28815003, -0.61121262,  0.71266001,
0.38611778,  1.80730863,  0.29263131,  0.2750411 , -0.38845123,
-0.11006106,  1.47905292, -1.4105652 ,  0.66418238,  0.18256365,
-1.28256444, -1.3695355 ,  0.42650071,  0.77092494, -0.5305579 ,
0.42480309,  0.34708949,  0.73591252,  0.47403442, -0.77881905,
-0.11366338,  1.00932778, -0.91371139, -0.71324135, -0.30580785,
1.02735852, -0.93417032, -1.47226409,  0.93934866,  0.27471834,
0.03695554, -0.94106201,  0.85831343,  0.26645201, -0.10778799,
-0.00442197,  1.23850543,  0.184529  , -0.14090602,  0.71551067)
dd = matrix(rr, ncol = 5, byrow = T)
prcomp(dd)$x
prcomp(dd, scale. = F, center = F)$x
dd %*% eigen(cov(dd))$vectors
princomp(dd)
predict(princomp(dd))
princomp(dd)
dd
eigen(cov(dd))$vectors
dd %*% eigen(cov(dd))$vectors
apply(dd, 2, scale) %*% eigen(cov(dd))$vectors
df %*% eigen(cov(df))$vectors
df = apply(dd, 2, scale)
df %*% eigen(cov(df))$vectors
prcomp(dd, scale. = F, center = F)$x
df = apply(dd, 2, scale)
df %*% eigen(cov(df))$vectors
eigen(cov(df))$vectors %*% dd
dd %*% eigen(cov(df))$vectors
dd %*% eigen(cov(dd))$vectors
princomp(dd)
princomp(dd) |> predict()
eigen(cov(dd))
bkg <- iris[iris$Species == 'setosa', 1:4]
tg <- iris[iris$Species != 'setosa', 1:4]
dim(tg); dim(bkg)
.a <- .5
cpc.cov <- cov(tg) - .a*cov(bkg)
(pp.pca <- princomp(tg))
(pp.cpc = princomp(tg, covmat = cpc.cov))
predict(pp.pca, tg)
library(dplyr)
xx=tg[sample(51), ] |>
mutate(
across(
.cols = where(is.numeric),
.fns = scale
)
md <- princomp(xx)
head(predict(md))
mine = as.matrix(xx) %*% eigen(cov(xx))$vectors
head(mine)
rr = c(-0.21863743, -0.33140168,  0.5099132 ,  2.20252799, -0.54560018,
-1.94904831, -0.67608332,  2.15373948, -0.64523754,  0.73561271,
-0.56500211, -1.1181086 ,  0.45536651,  1.16575647,  1.87225202,
-0.12431336, -0.74233273,  0.84508044, -1.74497781,  0.60209008,
0.36286266, -1.65460161,  1.50355519, -0.58690498, -1.41280284,
-0.46332501, -2.0423795 ,  0.5118267 , -0.29545595,  0.31082479,
-0.25556913, -1.90910408, -1.95942441, -0.14948754, -1.01426989,
0.41395884,  1.06308409, -0.21310867, -2.93303164,  1.2877029 ,
0.25242574, -0.39195897,  0.63831222, -0.9840341 ,  0.82177785,
-0.20113291, -1.29344461,  0.36425578, -0.27734873, -0.81784146,
-1.15944921,  1.62837626,  0.37867085, -0.11456555, -0.86259767,
0.46946389,  1.57479632,  0.28815003, -0.61121262,  0.71266001,
0.38611778,  1.80730863,  0.29263131,  0.2750411 , -0.38845123,
-0.11006106,  1.47905292, -1.4105652 ,  0.66418238,  0.18256365,
-1.28256444, -1.3695355 ,  0.42650071,  0.77092494, -0.5305579 ,
0.42480309,  0.34708949,  0.73591252,  0.47403442, -0.77881905,
-0.11366338,  1.00932778, -0.91371139, -0.71324135, -0.30580785,
1.02735852, -0.93417032, -1.47226409,  0.93934866,  0.27471834,
0.03695554, -0.94106201,  0.85831343,  0.26645201, -0.10778799,
-0.00442197,  1.23850543,  0.184529  , -0.14090602,  0.71551067)
dd = matrix(rr, ncol = 5, byrow = T)
princomp(dd) |> predict()
class(dd)
eigen(cov(dd))$vectors
dd %*% eigen(cov(dd))$vectors
dd <- iris[,1:4]
dd
#dd = matrix(rr, ncol = 5, byrow = T)
princomp(dd) |> predict()
#dd = matrix(rr, ncol = 5, byrow = T)
princomp(dd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors
#dd = matrix(rr, ncol = 5, byrow = T)
princomp(dd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors |> head()
dd <- iris[,1:4]
sdd <- apply(dd, 2, scale)
#dd = matrix(rr, ncol = 5, byrow = T)
princomp(sdd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors |> head()
as.matrix(sdd) %*% eigen(cov(sdd))$vectors |> head()
dd = matrix(rr, ncol = 5, byrow = T)
dd = apply(dd, 2, scale)
princomp(dd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors |> head()
dd
princomp(dd) |> predict() |> head()
summary(dd)
rr = c(-0.21863743, -0.33140168,  0.5099132 ,  2.20252799, -0.54560018,
-1.94904831, -0.67608332,  2.15373948, -0.64523754,  0.73561271,
-0.56500211, -1.1181086 ,  0.45536651,  1.16575647,  1.87225202,
-0.12431336, -0.74233273,  0.84508044, -1.74497781,  0.60209008,
0.36286266, -1.65460161,  1.50355519, -0.58690498, -1.41280284,
-0.46332501, -2.0423795 ,  0.5118267 , -0.29545595,  0.31082479,
-0.25556913, -1.90910408, -1.95942441, -0.14948754, -1.01426989,
0.41395884,  1.06308409, -0.21310867, -2.93303164,  1.2877029 ,
0.25242574, -0.39195897,  0.63831222, -0.9840341 ,  0.82177785,
-0.20113291, -1.29344461,  0.36425578, -0.27734873, -0.81784146,
-1.15944921,  1.62837626,  0.37867085, -0.11456555, -0.86259767,
0.46946389,  1.57479632,  0.28815003, -0.61121262,  0.71266001,
0.38611778,  1.80730863,  0.29263131,  0.2750411 , -0.38845123,
-0.11006106,  1.47905292, -1.4105652 ,  0.66418238,  0.18256365,
-1.28256444, -1.3695355 ,  0.42650071,  0.77092494, -0.5305579 ,
0.42480309,  0.34708949,  0.73591252,  0.47403442, -0.77881905,
-0.11366338,  1.00932778, -0.91371139, -0.71324135, -0.30580785,
1.02735852, -0.93417032, -1.47226409,  0.93934866,  0.27471834,
0.03695554, -0.94106201,  0.85831343,  0.26645201, -0.10778799,
-0.00442197,  1.23850543,  0.184529  , -0.14090602,  0.71551067)
dd = matrix(rr, ncol = 5, byrow = T)
dd
princomp(dd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors |> head()
dd = matrix(rr, ncol = 5, byrow = T)
dd = apply(dd, 2, scale)
princomp(dd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors |> head()
rr = c(-0.09676631, -0.13276716,  0.31137172,  2.18275283, -0.70155925,
-2.67382909, -0.404242  ,  2.01167629, -0.49143201,  0.83978146,
-0.61259958, -0.75238572,  0.25495092,  1.20917595,  2.20719546,
0.04370845, -0.45642073,  0.65805458, -1.52413949,  0.67914941,
0.76924895, -1.1749332 ,  1.33915308, -0.43665502, -1.74483221,
-0.46117412, -1.48035111,  0.31335096, -0.16297076,  0.32874781,
-0.15176787, -1.375382  , -2.24280695, -0.02589961, -1.26538413,
0.84534537,  0.96554436, -0.4364916 , -2.63977753,  1.50396388,
0.60477769, -0.18046271,  0.44418225, -0.80957781,  0.94344092,
-0.07069721, -0.89048219,  0.16070983, -0.14596724, -1.02907435,
-1.49789656,  1.41077436,  0.17562017,  0.00689377, -1.08291751,
0.92800782,  1.36857424,  0.08198925, -0.45948103,  0.81216862,
0.80388229,  1.55170335,  0.0866245 ,  0.37275261, -0.51250396,
0.06493409,  1.29316574, -1.67509012,  0.73817445,  0.17444548,
-1.68124936, -0.95041216,  0.22509336,  0.8384107 , -0.6834629 ,
0.86149547,  0.40161955,  0.54513588,  0.55961663, -0.98212912,
0.05956923,  0.92320533, -1.16116551, -0.55529077, -0.41308129,
1.758868  , -0.60751401, -1.73890885,  0.99656844,  0.28531057,
0.28388268, -0.61294198,  0.67174222,  0.36468705, -0.17485697,
0.22226005,  1.10370803, -0.02519197, -0.01784116,  0.81559806)
dd = matrix(rr, ncol = 5, byrow = T)
princomp(dd) |> predict() |> head()
as.matrix(dd) %*% eigen(cov(dd))$vectors |> head()
dd
cov(dd)
eigen(cov(dd))
princomp(dd) |> predict() |> head()
tg <- c(-3.72817881e-01,  2.35781893e+00,  9.52373129e-01,
-1.23207529e+00, -1.35373636e-01, -2.75088658e+00,
-1.44565392e+00, -3.67735468e-01, -9.15524666e-01,
1.19316790e+00,  6.45886385e-01,  2.27935790e-01,
-8.25879835e-01, -2.13604886e+00,  1.45729461e+00,
-6.64865140e-01, -3.31959791e-01,  8.97809747e-01,
-1.26341848e+00,  1.78650059e-01,  5.74221532e-01,
-2.82431319e-01, -1.62375229e-01,  8.60514381e-01,
1.29336736e+00, -1.06104425e+00,  1.69296857e-03,
-2.07308150e+00, -9.45943451e-01,  9.87707378e-01,
-2.53421009e-01, -8.98202057e-01,  3.35209677e-01,
-3.28962888e-01, -1.25342173e+00,  5.43083661e-01,
-5.63095592e-01,  3.93786596e-01,  1.85456263e+00,
-8.46501952e-01, -9.70341520e-02, -2.69688175e-01,
-9.07303818e-01,  7.13335866e-01, -8.87754557e-02,
-6.35416631e-01, -4.82385077e-01,  9.08874468e-01,
7.64020121e-01, -5.76105214e-01, -2.41295313e-01,
-3.05080350e-01,  2.72990346e-01, -9.00225238e-01,
1.07700676e+00, -2.63740442e-01, -1.08845498e+00,
4.88315737e-01,  3.30802578e-02,  2.19366425e-01,
-5.40926481e-01, -5.31418902e-01, -1.02062251e+00,
-1.85701631e-01,  1.42930500e+00,  1.23849789e+00,
-1.98423444e+00,  2.93985811e-01,  1.12175103e-01,
1.77956768e+00,  9.00462760e-01,  2.22285720e-01,
1.45700106e+00, -2.18768184e-01,  1.51920907e+00,
-4.41515299e-01, -1.41736972e+00,  1.78872417e+00,
-6.10622488e-01,  4.33594544e-01, -1.05067096e+00,
2.17004635e-01,  1.57270670e-01,  8.54749719e-01,
7.08140928e-01, -6.62102927e-01,  6.98734894e-02,
5.41928459e-01,  9.35732720e-01, -1.18047240e-01) |>
matrix(ncol = 3, byrow = T)
tg
tg <- c(-3.72817881e-01,  2.35781893e+00,  9.52373129e-01,
-1.23207529e+00, -1.35373636e-01, -2.75088658e+00,
-1.44565392e+00, -3.67735468e-01, -9.15524666e-01,
1.19316790e+00,  6.45886385e-01,  2.27935790e-01,
-8.25879835e-01, -2.13604886e+00,  1.45729461e+00,
-6.64865140e-01, -3.31959791e-01,  8.97809747e-01,
-1.26341848e+00,  1.78650059e-01,  5.74221532e-01,
-2.82431319e-01, -1.62375229e-01,  8.60514381e-01,
1.29336736e+00, -1.06104425e+00,  1.69296857e-03,
-2.07308150e+00, -9.45943451e-01,  9.87707378e-01,
-2.53421009e-01, -8.98202057e-01,  3.35209677e-01,
-3.28962888e-01, -1.25342173e+00,  5.43083661e-01,
-5.63095592e-01,  3.93786596e-01,  1.85456263e+00,
-8.46501952e-01, -9.70341520e-02, -2.69688175e-01,
-9.07303818e-01,  7.13335866e-01, -8.87754557e-02,
-6.35416631e-01, -4.82385077e-01,  9.08874468e-01,
7.64020121e-01, -5.76105214e-01, -2.41295313e-01,
-3.05080350e-01,  2.72990346e-01, -9.00225238e-01,
1.07700676e+00, -2.63740442e-01, -1.08845498e+00,
4.88315737e-01,  3.30802578e-02,  2.19366425e-01,
-5.40926481e-01, -5.31418902e-01, -1.02062251e+00,
-1.85701631e-01,  1.42930500e+00,  1.23849789e+00,
-1.98423444e+00,  2.93985811e-01,  1.12175103e-01,
1.77956768e+00,  9.00462760e-01,  2.22285720e-01,
1.45700106e+00, -2.18768184e-01,  1.51920907e+00,
-4.41515299e-01, -1.41736972e+00,  1.78872417e+00,
-6.10622488e-01,  4.33594544e-01, -1.05067096e+00,
2.17004635e-01,  1.57270670e-01,  8.54749719e-01,
7.08140928e-01, -6.62102927e-01,  6.98734894e-02,
5.41928459e-01,  9.35732720e-01, -1.18047240e-01) |>
matrix(ncol = 3, byrow = T)
bkg <-  c(0.33347533,  0.36430836,  0.21478783,
-0.92775526,  1.4296575 , -2.76993831,
0.02006388, -0.54578113, -0.77403327,
0.24777307,  0.31852144, -1.40134798,
0.97064303, -1.24666631,  0.48181065,
0.04255384,  1.1878615 ,  1.08570725,
-1.08709495,  0.42151549,  0.3266704 ,
1.70343797,  1.47077531,  0.56132922,
1.09689315, -0.1064623 , -0.70144871,
-0.50562651, -0.6835326 ,  0.24679015,
-0.31313455,  0.07533673,  0.07173422,
-0.94092169,  0.45996115,  1.3199714 ,
1.15323511,  0.70377752,  1.89052909,
-0.45883004,  0.46396412, -1.21457372,
-0.29095718,  0.66365128,  0.63770396,
0.09687361, -0.85122603, -1.85137769,
2.26776065, -0.44736813, -0.7062976 ,
0.45984999,  0.34123204, -2.20930237,
1.9401035 ,  0.10481936,  0.90732738,
-0.78398673,  0.39499973,  1.82054278,
0.81826508, -0.4178662 ,  0.33366304,
0.48926758,  0.97687369, -0.94555874,
-1.74444486,  0.31786982,  1.77559102,
1.68768549,  2.08049307, -1.07025485,
-0.51735321, -0.16085396,  2.77892012,
0.82724248, -0.56564656, -1.25791552,
1.06207022, -1.49553057,  0.40361163,
-0.7828266 , -0.86044682,  0.78628296,
0.27438727, -0.22117765, -0.28365583,
-0.64895607, -1.5218617 , -1.90233381) |>
matrix(nrow = 3,byrow = T)
bkg
bkg <-  c(0.33347533,  0.36430836,  0.21478783,
-0.92775526,  1.4296575 , -2.76993831,
0.02006388, -0.54578113, -0.77403327,
0.24777307,  0.31852144, -1.40134798,
0.97064303, -1.24666631,  0.48181065,
0.04255384,  1.1878615 ,  1.08570725,
-1.08709495,  0.42151549,  0.3266704 ,
1.70343797,  1.47077531,  0.56132922,
1.09689315, -0.1064623 , -0.70144871,
-0.50562651, -0.6835326 ,  0.24679015,
-0.31313455,  0.07533673,  0.07173422,
-0.94092169,  0.45996115,  1.3199714 ,
1.15323511,  0.70377752,  1.89052909,
-0.45883004,  0.46396412, -1.21457372,
-0.29095718,  0.66365128,  0.63770396,
0.09687361, -0.85122603, -1.85137769,
2.26776065, -0.44736813, -0.7062976 ,
0.45984999,  0.34123204, -2.20930237,
1.9401035 ,  0.10481936,  0.90732738,
-0.78398673,  0.39499973,  1.82054278,
0.81826508, -0.4178662 ,  0.33366304,
0.48926758,  0.97687369, -0.94555874,
-1.74444486,  0.31786982,  1.77559102,
1.68768549,  2.08049307, -1.07025485,
-0.51735321, -0.16085396,  2.77892012,
0.82724248, -0.56564656, -1.25791552,
1.06207022, -1.49553057,  0.40361163,
-0.7828266 , -0.86044682,  0.78628296,
0.27438727, -0.22117765, -0.28365583,
-0.64895607, -1.5218617 , -1.90233381) |>
matrix(ncol = 3,byrow = T)
tg
bkg
# Function
compute.cpca <- function(target, background, alpha = .1)
{
# performing centering and scaling
target <- apply(as.matrix(target), 2, scale)
background = apply(as.matrix(background), 2, scale)
# computing eigen vecs from new covariance matrix
cov.cpc <- cov(target) - alpha * cov(background)
e.vecs <- eigen(cov.cpc)$vectors
c.pca <- target %*% e.vecs
colnames(c.pca) <- paste0('cPCA', 1:ncol(c.pca))
return(c.pca)
}
compute.cpca(target = tg, background = bkg, alpha = .5)
tg <- c( 1.64787178, -2.98738858, -0.19857891,
1.64060836, -0.64497119, -1.05948908,
-1.5299392 ,  0.52140495,  1.82496745,
-0.70442456, -1.30009457,  1.0019424 ,
0.16153074,  1.55349739,  0.38542605,
-1.23519133, -0.97929122, -0.84156954,
0.3241749 , -0.65950961,  0.42314477,
-1.08073095, -1.28407239, -0.25167955,
0.3162096 ,  0.06796778, -0.88405221,
0.10964109, -0.27644823,  0.41340806,
1.31443008,  0.63098042,  0.49834194,
-1.22633615,  0.99904846, -1.4839234 ,
1.78696138,  1.1606878 ,  0.25578748,
-0.40475037, -0.34441073,  0.03545182,
0.01412943,  0.41288425, -1.44691991,
-0.52935498,  1.00742352,  0.75745374,
-0.48261197, -0.76490514,  1.19573657,
0.0445148 ,  0.36067165, -0.92784519,
-0.26422486,  0.06989865,  0.78009456,
-1.90288419,  0.84774011, -1.00911784,
0.45867543,  0.40690718,  1.70182685,
0.89041384,  1.41180265, -1.19412743,
1.47756078,  0.00486573, -0.73434998,
0.48836819, -1.07039112,  0.10754667,
-0.41348025,  1.9479634 , -0.36273835,
0.74457542,  0.12244146, -1.51795138,
-0.602965  , -0.67862254, -1.14504696,
-0.6178041 , -0.15776144,  1.18824051,
-1.44506974, -0.15031687,  1.57805763,
1.02010183, -0.22800177,  0.90996323) |>
matrix(ncol = 3, byrow = T)
tg
summary(tg)
apply(tg, 2, sd)
bkg <-  c( 0.12028766,  0.32259785,  0.20004765,
-1.17469841,  1.56810577, -2.07062093,
-0.20151191, -0.74139482, -0.55221065,
0.03229167,  0.26906801, -1.02944834,
0.77450848, -1.56080511,  0.40318868,
-0.17842003,  1.2854202 ,  0.86261074,
-1.33830267,  0.38947915,  0.28516375,
1.52691589,  1.61617693,  0.46368345,
0.90413755, -0.22778377, -0.49699101,
-0.74127185, -0.90244113,  0.22439383,
-0.54362804, -0.01524112,  0.09121779,
-1.18821724,  0.43442627,  1.04083019,
0.96198744,  0.71947387,  1.47488925,
-0.69322291,  0.43910617, -0.88735743,
-0.52085712,  0.67256198,  0.52178651,
-0.12264645, -1.09849282, -1.37181419,
2.10634207, -0.62633942, -0.50067987,
0.25004461,  0.29561914, -1.64410997,
1.76991552,  0.01922725,  0.72690598,
-1.02708208,  0.35847936,  1.42164627,
0.6180523 , -0.59184848,  0.29048349,
0.28024953,  1.03875272, -0.68270084,
-2.01324585,  0.26830619,  1.38744865,
1.51074181,  2.32900267, -0.77756501,
-0.75331239, -0.29137349,  2.15074409,
0.62726997, -0.76461965, -0.92033026,
0.86838262, -1.85175424,  0.34369777,
-1.0258909 , -1.10927291,  0.63481988,
0.05961818, -0.36189838, -0.17914973,
-0.88843747, -1.88253816, -1.41057971) |>
matrix(ncol = 3,byrow = T)
compute.cpca
compute.cpca <- function(target, background, alpha = .1)
{
# computing eigen vecs from new covariance matrix
cov.cpc <- cov(target) - alpha * cov(background)
e.vecs <- eigen(cov.cpc)$vectors
c.pca <- target %*% e.vecs
colnames(c.pca) <- paste0('cPCA', 1:ncol(c.pca))
return(c.pca)
}
compute.cpca(target = tg, background = bkg, alpha = .5)
library(topicmodels)
library(tm)
install.packages('tm.plugin.webmining')
install.packages('quanteda')
install.packages('topicmodels')
install_github("mannau/tm.plugin.webmining")
library(remotes)
install_remote("mannau/tm.plugin.webmining")
install_github("mannau/tm.plugin.webmining")
install_github("mannau/boilerpipeR", args = "--no-multiarch")
library(gutenbergr)
titles <- c("New King James Version")
books <- gutenberg_works(title %in% titles) %>%
gutenberg_download(meta_fields = "title")
library(dplyr)
titles <- c("New King James Version")
library(gutenbergr)
books <- gutenberg_works(title %in% titles) %>%
gutenberg_download(meta_fields = "title")
titles
titles <- c("Pride and Prejudice")
library(gutenbergr)
books <- gutenberg_works(title %in% titles) %>%
gutenberg_download(meta_fields = "title")
gutenberg_download(10)
gutenberg_download(11)
gutenberg_download(9)
kjv = gutenberg_download(10)
write.csv(kjv, '/home/nc-workforce/Documents/Desktop/Books/NLP and text processing/kjv.csv')
install.packages('MSwM')
setwd("~/Documents/Text processing NLP/word models/Topic Modelling")
